#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running precommit checks..."

# Change to the promptrite directory where the actual project is
cd promptrite || exit 1

# Run ultracite format (ignore exit code - don't fail on formatting issues)
echo "ğŸ“ Formatting code with ultracite..."
npx ultracite format || true
echo "âœ“ Format step completed"

# Run build - THIS IS THE CRITICAL CHECK
echo "ğŸ—ï¸  Building project..."
pnpm build
if [ $? -ne 0 ]; then
  echo "âŒ Build failed - commit rejected"
  exit 1
fi

echo "âœ… All checks passed!"
exit 0